!function(){"use strict";class e{constructor(e,t,s,n){let{item:i,handleCardClick:r}=e;this._templateSelector=t,this._name=i.name,this._link=i.link,this._likes=i.likes,this._ownerId=i.owner._id,this._id=i._id,this._handleCardClick=r,this._handleDeleteClick=s,this._handleLikeClick=n,this._item=i}_countLike(){this._likes.length<1?this._likeCounter.textContent="":this._likeCounter.textContent=this._likes.length}updateLike(e){this._likeCounter.textContent=e.likes.length,this._likeButton.classList.toggle("gallery__like-button_active"),0==this._likeCounter.textContent&&(this._likeCounter.textContent="")}_checkInitialLike(e){this._likes.some((t=>t._id==e._id))&&this._likeButton.classList.add("gallery__like-button_active")}_compareID(e){this._deleteButton=this._element.querySelector(".gallery__delete-button"),this._ownerId!==e._id&&(this._deleteButton.style.display="none")}_getTemplate(){return this._element=this._templateSelector.querySelector(".gallery__card").cloneNode(!0),this._element}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{const e=this._likeButton.classList.contains("gallery__like-button_active");this._handleLikeClick(this,e)})),this._element.querySelector(".gallery__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardPicture.addEventListener("click",(()=>this._handleCardClick({name:this._name,link:this._link})))}removeCard(){this._element.remove()}generateCard(e){return this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".gallery__like-button"),this._cardPicture=this._element.querySelector(".gallery__picture"),this._likeCounter=this._element.querySelector(".gallery__like-counter"),this._setEventListeners(),this._compareID(e),this._checkInitialLike(e),this._countLike(),this._element.querySelector(".gallery__text").textContent=this._name,this._cardPicture.src=this._link,this._cardPicture.alt=this._name,this._element}}class t{constructor(e,t){this._settings=e,this._formElement=t}_showInputError(e){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.add(this._settings.inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._settings.errorClass)}_hideInputError(e){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._settings.inputErrorClass),this._errorElement.classList.remove(this._settings.errorClass),this._errorElement.textContent=""}_hasInvalidInput(e){return Array.from(e).some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1)}_handleInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputList=this._formElement.querySelectorAll(this._settings.inputSelector),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._handleInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){this._popup=document.querySelector(e),this._handleEscapeClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup_visible"),document.addEventListener("keydown",this._handleEscapeClose)}close(){this._popup.classList.remove("popup_visible"),document.removeEventListener("keydown",this._handleEscapeClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_visible")||e.target.classList.contains("popup__close-button-icon"))&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._button=this._form.querySelector(".popup__button"),this._inputList=this._popup.querySelectorAll(".popup__input")}getInputValues(){return this._data={},this._inputList.forEach((e=>{this._data[e.name]=e.value})),this._data}openWithData(e){super.open(),e&&(this._data=e)}close(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Save";this._button.textContent=e,super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{this._button.textContent="Saving...",e.preventDefault(),this._handleSubmit(this._data)}))}}const i={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_active"},r=document.querySelector("#card-template").content,o=document.querySelector(".popup__form-profile"),a=document.querySelector(".user__edit-button"),l=document.querySelector(".user__add-button"),c=document.querySelector(".popup__input_value_name"),h=document.querySelector(".popup__input_value_about"),_=document.querySelector(".popup__form-addCard"),u=document.querySelector(".user__avatar-wrapper"),d=document.querySelector(".popup__form-avatar");let p={};const m=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}sendCardData(e){return this._name=e.name,this._link=e.link,fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:this._name,link:this._link})}).then(this._checkResponce)}setUserInfo(e){let{name:t,about:s,avatar:n}=e;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s,avatar:n})}).then(this._checkResponce)}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(this._checkResponce)}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(this._checkResponce)}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e._id),{method:"DELETE",headers:this._headers}).then(this._checkResponce)}likeAdd(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e._id),{method:"PUT",headers:this._headers}).then(this._checkResponce)}likeDelete(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e._id),{method:"DELETE",headers:this._headers}).then(this._checkResponce)}editProfilePhoto(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponce)}_checkResponce(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"302ca387-b31a-4cb2-8cb9-197e187dc382","Content-Type":"application/json"}}),k=new n(".popup_type_profile",(function(){m.setUserInfo(k.getInputValues()).then((e=>{C.setUserInfo(e),k.close()})).catch((e=>{console.log(e)}))}));k.setEventListeners();const v=new n(".popup_type_addCard",(function(){const e=v.getInputValues(),t={name:e.title,link:e.url};m.sendCardData(t).then((e=>{E.addItem(e),v.close()}))}));v.setEventListeners();const g=new class extends s{constructor(e){super(e),this._elementPic=this._popup.querySelector(".popup__image"),this._elementText=this._popup.querySelector(".popup__image-text")}open(e){let{name:t,link:s}=e;this._elementPic.src=s,this._elementPic.alt="".concat(t," photo"),this._elementText.textContent=t,super.open()}}(".popup_type_image");g.setEventListeners();const y=new n(".popup_type_delete",(function(e){m.deleteCard(e).then((t=>{e.removeCard(),y.close("Yes")})).catch((e=>{console.log(e)}))}));y.setEventListeners();const b=new n(".popup_type_avatar",(function(){const e=b.getInputValues();m.editProfilePhoto(e.avatar).then((t=>{C.setUserAvatar(e.avatar),b.close()})).catch((e=>{console.log(e)}))}));b.setEventListeners();const E=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderedItems=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e){const t=this._renderer(e);this._container.prepend(t)}renderItems(e){Array.from(e).forEach((e=>{this.addItem(e)}))}}({items:[],renderer:t=>function(t){let{item:s}=t;return new e({item:s,handleCardClick:e=>{let{name:t,link:s}=e;g.open({name:t,link:s})}},r,q,I).generateCard(p)}({item:t})},".gallery"),C=new class{constructor(e,t){let{userName:s,userInfo:n}=e;this._name=document.querySelector(s),this._about=document.querySelector(n),this._avatar=document.querySelector(t)}getUserInfo(){return this._userData={name:this._name.textContent,about:this._about.textContent},this._userData}setUserAvatar(e){this._avatar.src=e}setUserInfo(e){this._name.textContent=e.name,this._about.textContent=e.about}}({userName:".user__name",userInfo:".user__info"},".user__avatar");Promise.all([m.getUserInfo(),m.getInitialCards()]).then((e=>{let[t,s]=e;C.setUserInfo(t),C.setUserAvatar(t.avatar),p=t,E.renderItems(s)})).catch((e=>{console.log(e)}));const f=new t(i,_);f.enableValidation();const L=new t(i,o);L.enableValidation();const S=new t(i,d);function I(e,t){t?m.likeDelete(e).then((t=>{e.updateLike(t)})).catch((e=>{console.log(e)})):m.likeAdd(e).then((t=>{e.updateLike(t)})).catch((e=>{console.log(e)}))}function q(e){y.openWithData(e)}S.enableValidation(),a.addEventListener("click",(()=>{L.resetValidation(),k.open();const e=C.getUserInfo();c.value=e.name,h.value=e.about})),l.addEventListener("click",(()=>{f.resetValidation(),v.open()})),u.addEventListener("click",(()=>{S.resetValidation(),b.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUYsTUFHcEJoQyxFQUFJb0IsUUFBUWpILEdBQ1B5RyxNQUFNOUcsSUFDSEssRUFBS04sV0FBV0MsTUFDakJpSSxPQUFNQyxJQUNMQyxRQUFRQyxJQUFJRixNQUs1QixTQUFTMUosRUFBa0I2QixHQUN2QnlJLEVBQVk1RCxhQUFhN0UsR0EvQzdCZ0ssRUFBWTdHLG1CQWlGWmtDLEVBQVd6RSxpQkFBaUIsU0FBUyxLQUNqQ21KLEVBQWE3RyxrQkFDYndFLEVBQWlCM0QsT0FDakIsTUFBTWtHLEVBQWlCdEMsRUFBaUJiLGNBQ3hDdkIsRUFBVVgsTUFBUXFGLEVBQWV2TCxLQUNqQzhHLEVBQVVaLE1BQVFxRixFQUFlckQsU0FHckN0QixFQUFjMUUsaUJBQWlCLFNBQVMsS0FDcENrSixFQUFhNUcsa0JBQ2I4RSxFQUFpQmpFLFVBRXJCMkIsRUFBVzlFLGlCQUFpQixTQUFTLEtBQ2pDb0osRUFBWTlHLGtCQUNad0YsRUFBZTNFLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9mb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbSwgaGFuZGxlQ2FyZENsaWNrIH0sIHRlbXBsYXRlU2VsZWN0b3IsIGhhbmRsZURlbGV0ZUNsaWNrLCBoYW5kbGVMaWtlQ2xpY2spIHtcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX25hbWUgPSBpdGVtLm5hbWU7XG4gICAgICAgIHRoaXMuX2xpbmsgPSBpdGVtLmxpbms7XG4gICAgICAgIHRoaXMuX2xpa2VzID0gaXRlbS5saWtlcztcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGl0ZW0ub3duZXIuX2lkO1xuICAgICAgICB0aGlzLl9pZCA9IGl0ZW0uX2lkO1xuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgICAgICAgdGhpcy5faXRlbSA9IGl0ZW07XG4gICAgfVxuICAgIF9jb3VudExpa2UoKSB7XG4gICAgICAgIGlmICh0aGlzLl9saWtlcy5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVMaWtlKHJlcykge1xuICAgICAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IHJlcy5saWtlcy5sZW5ndGg7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnZ2FsbGVyeV9fbGlrZS1idXR0b25fYWN0aXZlJyk7XG4gICAgICAgIGlmICh0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2NoZWNrSW5pdGlhbExpa2UoZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5fbGlrZXMuc29tZShpdGVtID0+IGl0ZW0uX2lkID09IGRhdGEuX2lkKSkge1xuICAgICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdnYWxsZXJ5X19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY29tcGFyZUlEKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fZGVsZXRlLWJ1dHRvbicpO1xuICAgICAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gZGF0YS5faWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlU2VsZWN0b3JcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fY2FyZCcpXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgICB9XG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNMaWtlZCA9IHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdnYWxsZXJ5X19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLCBpc0xpa2VkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2RlbGV0ZS1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fY2FyZFBpY3R1cmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soe1xuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcbiAgICAgICAgICAgIGxpbms6IHRoaXMuX2xpbmtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICByZW1vdmVDYXJkKCkge1xuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIH1cbiAgICBnZW5lcmF0ZUNhcmQoZGF0YSkge1xuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2xpa2UtYnV0dG9uJyk7XG4gICAgICAgIHRoaXMuX2NhcmRQaWN0dXJlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fcGljdHVyZScpO1xuICAgICAgICB0aGlzLl9saWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2xpa2UtY291bnRlcicpO1xuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9jb21wYXJlSUQoZGF0YSk7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5pdGlhbExpa2UoZGF0YSk7XG4gICAgICAgIHRoaXMuX2NvdW50TGlrZSgpO1xuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5X190ZXh0JykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgICAgICB0aGlzLl9jYXJkUGljdHVyZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgICAgICB0aGlzLl9jYXJkUGljdHVyZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgfVxuXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gICAgfVxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICB9XG5cbiAgICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgICAgICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKGlucHV0TGlzdCk7XG4gICAgICAgIHJldHVybiBpbnB1dHMuc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9oYW5kbGVJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgICAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIH07XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgfVxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfdmlzaWJsZScpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfdmlzaWJsZScpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xuICAgIH1cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX3Zpc2libGUnKSB8fCBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ1dHRvbi1pY29uJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgICAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcbiAgICB9XG4gICAgZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSB7fTtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9kYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICAgIH1cbiAgICBvcGVuV2l0aERhdGEoZGF0YSkge1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjbG9zZShidXR0b25UZXh0ID0gJ1NhdmUnKSB7XG4gICAgICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IGJ1dHRvblRleHQ7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB9XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCh0aGlzLl9kYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfVxufSIsIi8vcGFnZSBzZXR0aW5nc1xuXG5leHBvcnQgY29uc3QgcGFnZVNldHRpbmdzID0ge1xuICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX2FjdGl2ZVwiXG59OyIsIi8vaW1wb3J0c1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvZm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQge1xuICAgIHBhZ2VTZXR0aW5ncyxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG4vL3ZhcmlhYmxlc1xuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudDtcbmNvbnN0IGVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtLXByb2ZpbGUnKTtcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudXNlcl9fZWRpdC1idXR0b24nKTtcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudXNlcl9fYWRkLWJ1dHRvbicpO1xuY29uc3QgaW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF92YWx1ZV9uYW1lJyk7XG5jb25zdCBpbnB1dEluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3ZhbHVlX2Fib3V0Jyk7XG5jb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybS1hZGRDYXJkJyk7XG5jb25zdCB1c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnVzZXJfX2F2YXRhci13cmFwcGVyJyk7XG5jb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtLWF2YXRhcicpO1xubGV0IGN1cnJlbnRVc2VySW5mbyA9IHt9O1xuXG4vL2NsYXNzIGluc3RhbmNlc1xuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjMwMmNhMzg3LWIzMWEtNGNiMi04Y2I5LTE5N2UxODdkYzM4MlwiLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgIH1cbn0pO1xuXG5jb25zdCBwb3B1cEVkaXRQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX3Byb2ZpbGUnLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XG5wb3B1cEVkaXRQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwQWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfYWRkQ2FyZCcsIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KTtcbnBvcHVwQWRkQ2FyZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnLnBvcHVwX3R5cGVfaW1hZ2UnKTtcbnBvcHVwSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfZGVsZXRlJywgaGFuZGxlRGVsZXRlQ2FyZEZvcm1TdWJtaXQpO1xuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBGb3JBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwX3R5cGVfYXZhdGFyJywgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XG5wb3B1cEZvckF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwYWdlR2FsbGVyeSA9IG5ldyBTZWN0aW9uKHtcbiAgICBpdGVtczogW10sXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBjcmVhdGVDYXJkKHsgaXRlbSB9KTtcbiAgICB9XG59LCAnLmdhbGxlcnknKTtcblxuY29uc3QgdXNlckluZm9JbnN0YW5jZSA9IG5ldyBVc2VySW5mbyh7IHVzZXJOYW1lOiAnLnVzZXJfX25hbWUnLCB1c2VySW5mbzogJy51c2VyX19pbmZvJyB9LCAnLnVzZXJfX2F2YXRhcicpO1xuXG4vL2luaXRpYWxQYWdlXG5cblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcbiAgICAudGhlbigoW3VzZXJEYXRhLCBjYXJkRGF0YV0pID0+IHtcbiAgICAgICAgdXNlckluZm9JbnN0YW5jZS5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XG4gICAgICAgIHVzZXJJbmZvSW5zdGFuY2Uuc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgICAgICBjdXJyZW50VXNlckluZm8gPSB1c2VyRGF0YTtcbiAgICAgICAgcGFnZUdhbGxlcnkucmVuZGVySXRlbXMoY2FyZERhdGEpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSk7XG5cblxuLy92YWxpZGF0b3JzXG5cbmNvbnN0IHBvcHVwQWRkQ2FyZCA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhZ2VTZXR0aW5ncywgYWRkQ2FyZEZvcm0pO1xucG9wdXBBZGRDYXJkLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgcG9wdXBQcm9maWxlID0gbmV3IEZvcm1WYWxpZGF0b3IocGFnZVNldHRpbmdzLCBlZGl0Rm9ybSk7XG5wb3B1cFByb2ZpbGUuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhZ2VTZXR0aW5ncywgYXZhdGFyRm9ybSk7XG5hdmF0YXJQb3B1cC5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vZnVuY3Rpb25zXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoeyBpdGVtIH0pIHtcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xuICAgICAgICAgICAgaXRlbSxcbiAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljazogKHsgbmFtZSwgbGluayB9KSA9PiB7XG4gICAgICAgICAgICAgICAgcG9wdXBJbWFnZS5vcGVuKHsgbmFtZSwgbGluayB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY2FyZFRlbXBsYXRlLFxuICAgICAgICBoYW5kbGVEZWxldGVDbGljaywgaGFuZGxlTGlrZUNsaWNrKTtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKGN1cnJlbnRVc2VySW5mbyk7XG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KCkge1xuICAgIGNvbnN0IGRhdGEgPSBwb3B1cEZvckF2YXRhci5nZXRJbnB1dFZhbHVlcygpO1xuICAgIGFwaS5lZGl0UHJvZmlsZVBob3RvKGRhdGEuYXZhdGFyKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHVzZXJJbmZvSW5zdGFuY2Uuc2V0VXNlckF2YXRhcihkYXRhLmF2YXRhcik7XG4gICAgICAgICAgICBwb3B1cEZvckF2YXRhci5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgfSlcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGRhdGEsIGlzTGlrZWQpIHtcbiAgICBpZiAoaXNMaWtlZCkge1xuICAgICAgICBhcGkubGlrZURlbGV0ZShkYXRhKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIGRhdGEudXBkYXRlTGlrZShyZXMpO1xuICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBhcGkubGlrZUFkZChkYXRhKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIGRhdGEudXBkYXRlTGlrZShyZXMpO1xuICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGRhdGEpIHtcbiAgICBkZWxldGVQb3B1cC5vcGVuV2l0aERhdGEoZGF0YSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmRGb3JtU3VibWl0KGRhdGEpIHtcbiAgICBhcGkuZGVsZXRlQ2FyZChkYXRhKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGRhdGEucmVtb3ZlQ2FyZCgpO1xuICAgICAgICAgICAgZGVsZXRlUG9wdXAuY2xvc2UoJ1llcycpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgfSlcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoKSB7XG4gICAgYXBpLnNldFVzZXJJbmZvKHBvcHVwRWRpdFByb2ZpbGUuZ2V0SW5wdXRWYWx1ZXMoKSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgdXNlckluZm9JbnN0YW5jZS5zZXRVc2VySW5mbyhyZXMpO1xuICAgICAgICAgICAgcG9wdXBFZGl0UHJvZmlsZS5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgfSlcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoKSB7XG4gICAgY29uc3QgZ2V0VmFsdWVzID0gcG9wdXBBZGRDYXJkRm9ybS5nZXRJbnB1dFZhbHVlcygpO1xuICAgIGNvbnN0IGRhdGEgPSB7IG5hbWU6IGdldFZhbHVlcy50aXRsZSwgbGluazogZ2V0VmFsdWVzLnVybCB9O1xuICAgIGFwaS5zZW5kQ2FyZERhdGEoZGF0YSkudGhlbigoaXRlbSkgPT4ge1xuICAgICAgICBwYWdlR2FsbGVyeS5hZGRJdGVtKGl0ZW0pO1xuICAgICAgICBwb3B1cEFkZENhcmRGb3JtLmNsb3NlKCk7XG4gICAgfSk7XG59XG4vL2V2ZW50IGxpc3RlbmVyc1xuXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHBvcHVwUHJvZmlsZS5yZXNldFZhbGlkYXRpb24oKTtcbiAgICBwb3B1cEVkaXRQcm9maWxlLm9wZW4oKTtcbiAgICBjb25zdCB1c2VyQWN0dWFsSW5mbyA9IHVzZXJJbmZvSW5zdGFuY2UuZ2V0VXNlckluZm8oKTtcbiAgICBpbnB1dE5hbWUudmFsdWUgPSB1c2VyQWN0dWFsSW5mby5uYW1lO1xuICAgIGlucHV0SW5mby52YWx1ZSA9IHVzZXJBY3R1YWxJbmZvLmFib3V0O1xufSk7XG5cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgcG9wdXBBZGRDYXJkLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIHBvcHVwQWRkQ2FyZEZvcm0ub3BlbigpO1xufSk7XG51c2VyQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGF2YXRhclBvcHVwLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIHBvcHVwRm9yQXZhdGFyLm9wZW4oKTtcbn0pOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICAgIH1cbiAgICBzZW5kQ2FyZERhdGEoaXRlbSkge1xuICAgICAgICB0aGlzLl9uYW1lID0gaXRlbS5uYW1lO1xuICAgICAgICB0aGlzLl9saW5rID0gaXRlbS5saW5rO1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbGluazogdGhpcy5fbGlua1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25jZSk7XG4gICAgfVxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYWJvdXQsXG4gICAgICAgICAgICAgICAgICAgIGF2YXRhclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25jZSk7XG4gICAgfVxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbmNlKTtcbiAgICB9XG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbmNlKTtcbiAgICB9XG4gICAgZGVsZXRlQ2FyZChkYXRhKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2RhdGEuX2lkfWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25jZSk7XG4gICAgfVxuICAgIGxpa2VBZGQoZGF0YSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtkYXRhLl9pZH1gLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uY2UpO1xuICAgIH1cbiAgICBsaWtlRGVsZXRlKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7ZGF0YS5faWR9YCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbmNlKTtcbiAgICB9XG4gICAgZWRpdFByb2ZpbGVQaG90byhkYXRhKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgYXZhdGFyOiBkYXRhXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uY2UpO1xuICAgIH1cbiAgICBfY2hlY2tSZXNwb25jZShyZXMpIHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fZWxlbWVudFBpYyA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcbiAgICAgICAgdGhpcy5fZWxlbWVudFRleHQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlLXRleHQnKTtcbiAgICB9XG4gICAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgICAgICB0aGlzLl9lbGVtZW50UGljLnNyYyA9IGxpbms7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRQaWMuYWx0ID0gYCR7bmFtZX0gcGhvdG9gO1xuICAgICAgICB0aGlzLl9lbGVtZW50VGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICBhZGRJdGVtKGl0ZW0pIHtcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChjYXJkKTtcbiAgICB9XG5cbiAgICByZW5kZXJJdGVtcyhjYXJkRGF0YSkge1xuICAgICAgICBjb25zdCBkYXRhID0gQXJyYXkuZnJvbShjYXJkRGF0YSk7XG4gICAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIHRoaXMuYWRkSXRlbShpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lLCB1c2VySW5mbyB9LCBhdmF0YXIpIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWUpO1xuICAgICAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckluZm8pO1xuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhcik7XG4gICAgfVxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICB0aGlzLl91c2VyRGF0YSA9IHsgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCwgYWJvdXQ6IHRoaXMuX2Fib3V0LnRleHRDb250ZW50IH07XG4gICAgICAgIHJldHVybiB0aGlzLl91c2VyRGF0YTtcbiAgICB9XG4gICAgc2V0VXNlckF2YXRhcihkYXRhKSB7XG4gICAgICAgIHRoaXMuX2F2YXRhci5zcmMgPSBkYXRhO1xuICAgIH1cbiAgICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgICB9XG59Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsInRlbXBsYXRlU2VsZWN0b3IiLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsIml0ZW0iLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9pdGVtIiwiX2NvdW50TGlrZSIsImxlbmd0aCIsIl9saWtlQ291bnRlciIsInRleHRDb250ZW50IiwidXBkYXRlTGlrZSIsInJlcyIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2NoZWNrSW5pdGlhbExpa2UiLCJkYXRhIiwic29tZSIsImFkZCIsIl9jb21wYXJlSUQiLCJfZGVsZXRlQnV0dG9uIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJkaXNwbGF5IiwiX2dldFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImlzTGlrZWQiLCJjb250YWlucyIsIl9jYXJkUGljdHVyZSIsInJlbW92ZUNhcmQiLCJyZW1vdmUiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsIl9lcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0TGlzdCIsIl9zdWJtaXRCdXR0b24iLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJfaGFuZGxlSW5wdXRWYWxpZGl0eSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJmb3JFYWNoIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiZG9jdW1lbnQiLCJfaGFuZGxlRXNjYXBlQ2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwia2V5IiwiY2xvc2UiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsIl9mb3JtIiwiX2J1dHRvbiIsImdldElucHV0VmFsdWVzIiwiX2RhdGEiLCJpbnB1dCIsInZhbHVlIiwib3BlbldpdGhEYXRhIiwiYnV0dG9uVGV4dCIsInJlc2V0IiwicGFnZVNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImVkaXRGb3JtIiwiZWRpdEJ1dHRvbiIsImFkZENhcmRCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dEluZm8iLCJhZGRDYXJkRm9ybSIsInVzZXJBdmF0YXIiLCJhdmF0YXJGb3JtIiwiY3VycmVudFVzZXJJbmZvIiwiYXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsInNlbmRDYXJkRGF0YSIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwiX2NoZWNrUmVzcG9uY2UiLCJzZXRVc2VySW5mbyIsImFib3V0IiwiYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJkZWxldGVDYXJkIiwibGlrZUFkZCIsImxpa2VEZWxldGUiLCJlZGl0UHJvZmlsZVBob3RvIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImF1dGhvcml6YXRpb24iLCJwb3B1cEVkaXRQcm9maWxlIiwidXNlckluZm9JbnN0YW5jZSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInBvcHVwQWRkQ2FyZEZvcm0iLCJnZXRWYWx1ZXMiLCJ0aXRsZSIsInVybCIsInBhZ2VHYWxsZXJ5IiwiYWRkSXRlbSIsInBvcHVwSW1hZ2UiLCJfZWxlbWVudFBpYyIsIl9lbGVtZW50VGV4dCIsImRlbGV0ZVBvcHVwIiwicG9wdXBGb3JBdmF0YXIiLCJzZXRVc2VyQXZhdGFyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiY2FyZCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsImNhcmREYXRhIiwiY3JlYXRlQ2FyZCIsInVzZXJOYW1lIiwidXNlckluZm8iLCJfYWJvdXQiLCJfYXZhdGFyIiwiX3VzZXJEYXRhIiwiYWxsIiwidXNlckRhdGEiLCJwb3B1cEFkZENhcmQiLCJwb3B1cFByb2ZpbGUiLCJhdmF0YXJQb3B1cCIsInVzZXJBY3R1YWxJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==