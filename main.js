!function(){"use strict";class e{constructor(e,t){let{item:s,handleCardClick:n}=e;this._templateSelector=t,this._name=s.name,this._link=s.link,this._handleCardClick=n}_getTemplate(){return this._element=this._templateSelector.querySelector(".gallery__card").cloneNode(!0),this._element}_handleLikeButton(){this._likeButton.classList.toggle("gallery__like-button_active")}_handleDeleteButton(){this._element.remove()}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeButton()})),this._element.querySelector(".gallery__delete-button").addEventListener("click",(()=>{this._handleDeleteButton()})),this._cardPicture.addEventListener("click",(()=>this._handleCardClick({name:this._name,link:this._link})))}generateCard(){return this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".gallery__like-button"),this._cardPicture=this._element.querySelector(".gallery__picture"),this._setEventListeners(),this._element.querySelector(".gallery__text").textContent=this._name,this._cardPicture.src=this._link,this._cardPicture.alt=this._name,this._element}}class t{constructor(e,t){this._settings=e,this._formElement=t}_showInputError(e){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.add(this._settings.inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._settings.errorClass)}_hideInputError(e){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._settings.inputErrorClass),this._errorElement.classList.remove(this._settings.errorClass),this._errorElement.textContent=""}_hasInvalidInput(e){return Array.from(e).some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1)}_handleInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputList=this._formElement.querySelectorAll(this._settings.inputSelector),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._handleInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){this._popup=document.querySelector(e),this._handleEscapeClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup_visible"),document.addEventListener("keydown",this._handleEscapeClose)}close(){this._popup.classList.remove("popup_visible"),document.removeEventListener("keydown",this._handleEscapeClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_visible")||e.target.classList.contains("popup__close-button-icon"))&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".popup__form")}_getInputValues(){return this._data={},this._inputList=this._popup.querySelectorAll(".popup__input"),this._inputList.forEach((e=>{this._data[e.name]=e.value})),this._data}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(),this.close()}))}}const i={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_active"},r=document.querySelector("#card-template").content,o=document.querySelector(".popup__form-profile"),a=document.querySelector(".user__edit-button"),l=document.querySelector(".user__add-button"),u=document.querySelector(".popup__input_value_name"),_=document.querySelector(".popup__input_value_about"),c=document.querySelector(".popup__form-addCard"),p=new n(".popup_type_profile",(function(){y.setUserInfo(p._getInputValues())}));p.setEventListeners();const d=new n(".popup_type_addCard",(function(){const e=d._getInputValues(),t={name:e.title,link:e.url};m.addItem(g({item:t})),c.reset()}));d.setEventListeners();const h=new class extends s{open(e){let{name:t,link:s}=e;this._elementPic=this._popup.querySelector(".popup__image"),this._elementText=this._popup.querySelector(".popup__image-text"),this._elementPic.src=s,this._elementPic.alt="".concat(t," photo"),this._elementText.textContent=t,super.open()}}(".popup_type_image");h.setEventListeners();const m=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderedItems=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:e=>{m.addItem(g({item:e}))}},".gallery");m.renderItems();const y=new class{constructor(e){let{userName:t,userInfo:s}=e;this._name=document.querySelector(t),this._about=document.querySelector(s)}getUserInfo(){return this._userData={name:this._name.textContent,about:this._about.textContent},this._userData}setUserInfo(e){this._name.textContent=e.name,this._about.textContent=e.about}}({userName:".user__name",userInfo:".user__info"}),E=new t(i,c);E.enableValidation();const v=new t(i,o);function g(t){let{item:s}=t;return new e({item:s,handleCardClick:e=>{let{name:t,link:s}=e;h.open({name:t,link:s})}},r).generateCard()}v.enableValidation(),a.addEventListener("click",(()=>{v.resetValidation(),p.open();const e=y.getUserInfo();u.value=e.name,_.value=e.about})),l.addEventListener("click",(()=>{E.resetValidation(),d.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FBS3FILE9BQU9oRyxZQUFjb0csRUFBS0QsUUhnQ0QsQ0FBRUwsU0FBVSxjQUFlQyxTQUFVLGdCQUlyRU0sRUFBZSxJQUFJbEcsRUFBYzJELEVBQWNTLEdBQ3JEOEIsRUFBYWxFLG1CQUViLE1BQU1tRSxFQUFlLElBQUluRyxFQUFjMkQsRUFBY0ksR0FLckQsU0FBU2UsRUFBVCxHQUE4QixJQUFWLEtBQUV4RyxHQUFRLEVBUzFCLE9BUmEsSUFBSUgsRUFBSyxDQUNkRyxLQUFBQSxFQUNBQyxnQkFBaUIsSUFBb0IsSUFBbkIsS0FBRUksRUFBRixLQUFRRSxHQUFXLEVBQ2pDa0csRUFBV25DLEtBQUssQ0FBRWpFLEtBQUFBLEVBQU1FLEtBQUFBLE1BR2hDZ0YsR0FDcUJqRSxlQVo3QnVHLEVBQWFuRSxtQkE2QmJnQyxFQUFXdEUsaUJBQWlCLFNBQVMsS0FDakN5RyxFQUFhcEUsa0JBQ2JzQyxFQUFpQnpCLE9BQ2pCLE1BQU13RCxFQUFpQjlCLEVBQWlCd0IsY0FDeEM1QixFQUFVVCxNQUFRMkMsRUFBZXpILEtBQ2pDd0YsRUFBVVYsTUFBUTJDLEVBQWVKLFNBR3JDL0IsRUFBY3ZFLGlCQUFpQixTQUFTLEtBQ3BDd0csRUFBYW5FLGtCQUNieUMsRUFBaUI1QixVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvZm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbSwgaGFuZGxlQ2FyZENsaWNrIH0sIHRlbXBsYXRlU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX25hbWUgPSBpdGVtLm5hbWU7XG4gICAgICAgIHRoaXMuX2xpbmsgPSBpdGVtLmxpbms7XG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB9XG4gICAgX2dldFRlbXBsYXRlKCkge1xuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fdGVtcGxhdGVTZWxlY3RvclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5X19jYXJkJylcbiAgICAgICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICAgIH1cbiAgICBfaGFuZGxlTGlrZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdnYWxsZXJ5X19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcbiAgICB9XG4gICAgX2hhbmRsZURlbGV0ZUJ1dHRvbigpIHtcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuX2VsZW1lbnQ7XG4gICAgICAgIGNhcmQucmVtb3ZlKCk7XG4gICAgfVxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2RlbGV0ZS1idXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbigpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fY2FyZFBpY3R1cmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soe1xuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcbiAgICAgICAgICAgIGxpbms6IHRoaXMuX2xpbmtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fbGlrZS1idXR0b24nKTtcbiAgICAgICAgdGhpcy5fY2FyZFBpY3R1cmUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5X19waWN0dXJlJyk7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX3RleHQnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgICAgIHRoaXMuX2NhcmRQaWN0dXJlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgICAgIHRoaXMuX2NhcmRQaWN0dXJlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB9XG5cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICB9XG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICAgICAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIH1cblxuICAgIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgICAgIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oaW5wdXRMaXN0KTtcbiAgICAgICAgcmV0dXJuIGlucHV0cy5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2hhbmRsZUlucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUlucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfTtcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF92aXNpYmxlJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF92aXNpYmxlJyk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XG4gICAgfVxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfdmlzaWJsZScpIHx8IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UtYnV0dG9uLWljb24nKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG4gICAgfVxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICAgICAgdGhpcy5fZGF0YSA9IHt9O1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fZGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB9XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0iLCIvL3BhZ2Ugc2V0dGluZ3NcblxuZXhwb3J0IGNvbnN0IHBhZ2VTZXR0aW5ncyA9IHtcbiAgICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXG4gICAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl9hY3RpdmVcIlxufTtcblxuLy9Jbml0aWFsIGNhcmRzIGRhdGFcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFt7XG4gICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCJcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIlxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIlxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIlxuICAgIH1cbl07IiwiLy9pbXBvcnRzXG5pbXBvcnQgXCIuL3BhZ2VzL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuL2NvbXBvbmVudHMvZm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHtcbiAgICBwYWdlU2V0dGluZ3MsXG4gICAgaW5pdGlhbENhcmRzXG59IGZyb20gXCIuL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbi8vdmFyaWFibGVzXG5cbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50O1xuY29uc3QgZWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0tcHJvZmlsZScpO1xuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51c2VyX19lZGl0LWJ1dHRvbicpO1xuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51c2VyX19hZGQtYnV0dG9uJyk7XG5jb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3ZhbHVlX25hbWUnKTtcbmNvbnN0IGlucHV0SW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdmFsdWVfYWJvdXQnKTtcbmNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtLWFkZENhcmQnKTtcblxuLy9jbGFzcyBpbnN0YW5jZXNcblxuY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9wcm9maWxlJywgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xucG9wdXBFZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cEFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2FkZENhcmQnLCBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCk7XG5wb3B1cEFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF90eXBlX2ltYWdlJyk7XG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBhZ2VHYWxsZXJ5ID0gbmV3IFNlY3Rpb24oe1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgIHBhZ2VHYWxsZXJ5LmFkZEl0ZW0oY3JlYXRlQ2FyZCh7IGl0ZW0gfSkpO1xuICAgIH1cbn0sICcuZ2FsbGVyeScpO1xucGFnZUdhbGxlcnkucmVuZGVySXRlbXMoKTtcblxuY29uc3QgdXNlckluZm9JbnN0YW5jZSA9IG5ldyBVc2VySW5mbyh7IHVzZXJOYW1lOiAnLnVzZXJfX25hbWUnLCB1c2VySW5mbzogJy51c2VyX19pbmZvJyB9KTtcblxuLy92YWxpZGF0b3JzXG5cbmNvbnN0IHBvcHVwQWRkQ2FyZCA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhZ2VTZXR0aW5ncywgYWRkQ2FyZEZvcm0pO1xucG9wdXBBZGRDYXJkLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgcG9wdXBQcm9maWxlID0gbmV3IEZvcm1WYWxpZGF0b3IocGFnZVNldHRpbmdzLCBlZGl0Rm9ybSk7XG5wb3B1cFByb2ZpbGUuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vL2Z1bmN0aW9uc1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKHsgaXRlbSB9KSB7XG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICAgICAgICAgIGl0ZW0sXG4gICAgICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xuICAgICAgICAgICAgICAgIHBvcHVwSW1hZ2Uub3Blbih7IG5hbWUsIGxpbmsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNhcmRUZW1wbGF0ZSk7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoKSB7XG4gICAgdXNlckluZm9JbnN0YW5jZS5zZXRVc2VySW5mbyhwb3B1cEVkaXRQcm9maWxlLl9nZXRJbnB1dFZhbHVlcygpKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoKSB7XG4gICAgY29uc3QgZ2V0VmFsdWVzID0gcG9wdXBBZGRDYXJkRm9ybS5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICBjb25zdCBpdGVtID0geyBuYW1lOiBnZXRWYWx1ZXMudGl0bGUsIGxpbms6IGdldFZhbHVlcy51cmwgfTtcbiAgICBwYWdlR2FsbGVyeS5hZGRJdGVtKGNyZWF0ZUNhcmQoeyBpdGVtIH0pKTtcbiAgICBhZGRDYXJkRm9ybS5yZXNldCgpO1xufVxuXG4vL2V2ZW50IGxpc3RlbmVyc1xuXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHBvcHVwUHJvZmlsZS5yZXNldFZhbGlkYXRpb24oKTtcbiAgICBwb3B1cEVkaXRQcm9maWxlLm9wZW4oKTtcbiAgICBjb25zdCB1c2VyQWN0dWFsSW5mbyA9IHVzZXJJbmZvSW5zdGFuY2UuZ2V0VXNlckluZm8oKTtcbiAgICBpbnB1dE5hbWUudmFsdWUgPSB1c2VyQWN0dWFsSW5mby5uYW1lO1xuICAgIGlucHV0SW5mby52YWx1ZSA9IHVzZXJBY3R1YWxJbmZvLmFib3V0O1xufSk7XG5cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgcG9wdXBBZGRDYXJkLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIHBvcHVwQWRkQ2FyZEZvcm0ub3BlbigpO1xuXG59KTsiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgICAgICB0aGlzLl9lbGVtZW50UGljID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuICAgICAgICB0aGlzLl9lbGVtZW50VGV4dCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UtdGV4dCcpO1xuICAgICAgICB0aGlzLl9lbGVtZW50UGljLnNyYyA9IGxpbms7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRQaWMuYWx0ID0gYCR7bmFtZX0gcGhvdG9gO1xuICAgICAgICB0aGlzLl9lbGVtZW50VGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfVxuXG4gICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKHsgdXNlck5hbWUsIHVzZXJJbmZvIH0pIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWUpO1xuICAgICAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckluZm8pO1xuICAgIH1cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgdGhpcy5fdXNlckRhdGEgPSB7IG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCB9O1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGE7XG4gICAgfVxuICAgIHNldFVzZXJJbmZvKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICAgIH1cbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwidGVtcGxhdGVTZWxlY3RvciIsIml0ZW0iLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2dldFRlbXBsYXRlIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xvbmVOb2RlIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfbGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJyZW1vdmUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmRQaWN0dXJlIiwiZ2VuZXJhdGVDYXJkIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsIl9lcnJvckVsZW1lbnQiLCJpZCIsImFkZCIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JDbGFzcyIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9pbnB1dExpc3QiLCJfc3VibWl0QnV0dG9uIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiX2hhbmRsZUlucHV0VmFsaWRpdHkiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZm9yRWFjaCIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsImRvY3VtZW50IiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImtleSIsImNsb3NlIiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsIl9mb3JtIiwiX2dldElucHV0VmFsdWVzIiwiX2RhdGEiLCJpbnB1dCIsInZhbHVlIiwicmVzZXQiLCJwYWdlU2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwiZWRpdEZvcm0iLCJlZGl0QnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImlucHV0TmFtZSIsImlucHV0SW5mbyIsImFkZENhcmRGb3JtIiwicG9wdXBFZGl0UHJvZmlsZSIsInVzZXJJbmZvSW5zdGFuY2UiLCJzZXRVc2VySW5mbyIsInBvcHVwQWRkQ2FyZEZvcm0iLCJnZXRWYWx1ZXMiLCJ0aXRsZSIsInVybCIsInBhZ2VHYWxsZXJ5IiwiYWRkSXRlbSIsImNyZWF0ZUNhcmQiLCJwb3B1cEltYWdlIiwiX2VsZW1lbnRQaWMiLCJfZWxlbWVudFRleHQiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwidXNlck5hbWUiLCJ1c2VySW5mbyIsIl9hYm91dCIsImdldFVzZXJJbmZvIiwiX3VzZXJEYXRhIiwiYWJvdXQiLCJkYXRhIiwicG9wdXBBZGRDYXJkIiwicG9wdXBQcm9maWxlIiwidXNlckFjdHVhbEluZm8iXSwic291cmNlUm9vdCI6IiJ9